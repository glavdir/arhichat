webpackJsonp([3],{259:function(t,e,n){"use strict";function s(t){n(294)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(268),r=n(297),a=n(5),o=s,c=a(i.a,r.a,!1,o,"data-v-7f930fb0",null);e.default=c.exports},268:function(t,e,n){"use strict";var s=n(21),i=n.n(s),r=n(296),a=n.n(r),o=new a.a.HTML2BBCode({weaknewline:!1});e.a={data:function(){return{pagetext:"",postid:"",time:0}},methods:{openBash:function(t){var e=this;this.$socket.emit("open_bash",t,function(t){e.postid=t.postid,e.pagetext=t.pagetext,e.time=t.time})},openPrevBash:function(){this.openBash({postid:this.postid,direction:"prev"})},openNextBash:function(){this.openBash({postid:this.postid,direction:"next"})},openLastBash:function(){this.openBash({postid:0,direction:"last"})},saveBash:function(t){var e=this;this.$socket.emit("save_bash",{postid:this.postid,pagetext:o.feed(this.pagetext).s},function(t){t?(e.postid=t.postid,e.time=t.time,e.flash("Сохранено","success",{timeout:2e3})):e.flash("ВНИМАНИЕ! Пост не сохранен!","error",{timeout:1e4})})},newBash:function(){this.postid="",this.pagetext="",this.time=0},editBash:function(t){this.pagetext=t.event.target.innerHTML}},computed:{postTitle:function(){return 0==this.time?"* новый пост":this.momentum(1e3*this.time).utc().add(this.$store.state.timezoneoffset,"hours").format("DD MMM YYYY")}},components:{"medium-editor":i.a},created:function(){this.openLastBash()}}},294:function(t,e,n){var s=n(295);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);n(4)("6a3be1ac",s,!0)},295:function(t,e,n){e=t.exports=n(3)(!1),e.push([t.i,"",""])},296:function(t,e,n){!function(e,n){t.exports=n()}(0,function(t){"use strict";function e(){this.name="",this.length=0}function n(){this.stack=[],this.length=0}function s(){this.s="",this.weaknewline=!0,this.stack=[]}function i(t){this.opts=t||{}}e.duptags=["div","span"],e.headingtags=["h1","h2","h3","h4","h5","h6"],e.selfendtags=["!doctype","meta","link","img","br"],e.newlinetags=["div","p","br","li","tr"].concat(e.headingtags),e.noemptytags=["head","style","script","span","a","font","color","size","face","strong","b","em","i","del","s","ins","u"],e.noemptyattrtags=["img"],e.prototype.findquoteend=function(t,e,n){var s=-1,i=e||0,r=t.length,a='"'===t[i];for(i++;i<r;)if("\\"===t[i])switch(i++,t[i]){case"u":i+=5;break;case"x":i+=3;break;default:i++}else{if(a&&'"'===t[i]||!a&&"'"===t[i]){s=i;break}if("\n"===t[i]&&!n)break;i++}return s},e.prototype.findscriptend=function(t,e){for(var n=-1,s=e||0,i=t.length,r=/(['"]|<\s*?\/\s*?script\s*?>)/gi;s<i;)if('"'===t[s]||"'"===t[s]){var a=this.findquoteend(t,s,!0);if(-1===a)break;s=a+1}else{r.lastIndex=s;var o=r.exec(t);if(!o||o.length<=0)break;if("<"===o[0][0]){n=r.lastIndex-o[0].length;break}s=r.lastIndex-1}return n},e.prototype.quote=function(t){if("'"===t[0]){for(var e='"',n=1,s=t.length-1,i=n;n<s;)if("\\"===t[n])switch(n++,t[n]){case"u":n+=5;break;case"x":n+=3;break;default:n++}else{if('"'===t[n]){e+=t.substr(i,n-i),e+='\\"',n++,i=n;break}n++}return i<s&&(e+=t.substr(i,s-i)),e+='"'}return t},e.prototype.parseStyle=function(t){for(var e=t.split(";"),n={},s=0,i=0;i<e.length;i++){var r=e[i].split(":");if(r.length>=2){s++;var a;if(a=r.length>2?r.slice(1).join(":").trim():r[1].trim(),"'"===a[0]&&"'"===a[a.length-1])try{a=JSON.parse(this.quote(a))}catch(t){}n[r[0].trim().toLowerCase()]=a}}return s>0?n:void 0},e.prototype.parseAttributes=function(t){t=t.trim();for(var e=/\s/,n=0,s=t.length,i=n,r=null,a=!1,o={},c=function(t,e){void 0===e&&(e=null),t=t.trim().toLowerCase(),o[t]=e};n<s;){if("="===t[n])r=t.substr(i,n-i),a=!1;else if(e.test(t[n]))r&&a?(c(r,t.substr(i,n-i)),a=!1,r=null):n-i>0&&(r=t.substr(i,n-i),c(r),r=null),i=n+1;else if(r&&!a)if(i=n,'"'===t[n]||"'"===t[n]){var h="'"===t[n];if(-1===(n=this.findquoteend(t,n)))break;var f=t.substr(i,n+1-i);h&&(f=this.quote(f));try{f=JSON.parse(f)}catch(t){}c(r,f),r=null,i=n+1}else a=!0;n++}if(i<s){var l=t.substr(i);r?c(r,l):c(l),r=null}var p=0;for(var u in o)p++;p>0&&(o.style&&(o.style=this.parseStyle(o.style)),this.attr=o)},e.prototype.parse=function(t){var s=0;if("<"!==t[s])throw new Error("not a tag");for(var i=t.length,r=/\s/;s<i;)if("<"===t[s])s++;else{if(">"===t[s])return this.length=s+1,this;if(!r.test(t[s]))break;s++}if(s>=i)return this.length=i,this;for(var a=s,o=!1;s<i&&!r.test(t[s]);){if(">"===t[s]){o=!0;break}if("/"===t[s])break;s++}if(s>=i)return this.length=s,this;if(this.name=t.substr(a,s-a).trim().toLowerCase(),this.name.length>0&&"/"===this.name[0])return this.length=s,this.name=this.name.substr(1),this.selfend=!0,this;if(e.selfendtags.indexOf(this.name)>=0&&(this.selfend=!0),!o){for(a=s;s<i&&">"!==t[s];)s++;if(s>=i)return this.length=s,this;if(s-a>0){var c=t.substr(a,s-a).trim(),h=c.length;h>0&&"/"===c[h-1]&&(this.selfend=!0,c=c.substr(0,h-1)),this.parseAttributes(c)}}if(s++,this.selfend)return this.length=s,this;var f=this,l=function(t){var e=(new n).parse(t);return f.content?f.content.append(e):f.content=e,e.length};if("script"===this.name){var p=this.findscriptend(t.substr(s));if(p<0)return this.length=i,this;this.content=new n;var u=t.substr(s,p);return this.content.length=p,(this.content.stack=[u],s+=p,(a=t.indexOf(">",s))<0)?(this.length=i,this):(this.length=a+1,this)}for(var d=0;s<i;){for(d++,a=s;s<i&&r.test(t[s]);)s++;for(;s<i&&"<"!==t[s];)s++;var g=s;for(s++;s<i&&r.test(t[s]);)s++;if(s>=i)return this.content=(new n).parse(t.substr(a)),this.length=i,this;if(s<i&&"/"===t[s]){for(s++;s<i&&r.test(t[s]);)s++;if(s>=i)return s+=l(t.substr(a)),this.length=i,this;for(var v=s,m=!1;s<i&&!r.test(t[s]);){if(">"===t[s]){m=!0;break}s++}if(s>v){if(!m)for(;s<i&&">"!==t[s];)s++;t.substr(v,s-v).trim().toLowerCase();return s++,this.length=s,g>a&&l(t.substr(a,g-a)),this}}s=a+l(t.substr(a))}return this.length=s,this},n.prototype.parse=function(t){if(!t)return this;for(var n=0,s=t.length,i=0,r=/\s/,a=this,o=function(e,n){e<n&&a.push(t.substr(e,n-e))};n<s;)switch(t[n]){case"<":o(i,n);for(var c=n+1;c<s&&r.test(t[c]);)c++;if(c<s&&"/"===t[c])return this;var h=(new e).parse(t.substr(n));this.push(h),n+=h.length,i=n;break;case">":default:n++}return o(i,s),this},n.prototype.push=function(t){this.length+=t.length,this.stack.push(t)},n.prototype.pop=function(){return this.stack.pop()},n.prototype.append=function(t){this.stack=this.stack.concat(t.stack),this.length+=t.length},function(){var t=new RegExp("<\\s*?("+e.duptags.join("|")+")\\s*?>\\s*?<\\s*?\\1\\s*?>(((?!<\\s*?\\1\\s*?>)[\\S\\s])*?)<\\s*?/\\s*?\\1\\s*?>\\s*?<\\s*?/\\s*?\\1\\s*?>","ig"),s=new RegExp("(<\\s*?("+e.newlinetags.join("|")+")[^>]*?>)\\s+","ig"),i=new RegExp("\\s+(<\\s*?/\\s*?("+e.newlinetags.join("|")+")\\s*?>)","ig"),r=new RegExp("<\\s*?("+e.noemptytags.join("|")+")[^>]*?><\\s*?/\\s*?\\1\\s*?>","ig");n.minify=function(e){for(e=e.replace(r,""),e=e.replace(s,"$1"),e=e.replace(i,"$1"),e=e.replace(/\s{2,}/g," ");t.test(e);)e=e.replace(t,"<$1>$2</$1>");return e=e.replace(/>\s{2,}/g,"> "),e=e.replace(/\s{2,}<\\s*?\//g," </")}}();var r={nbsp:" ",amp:"&",lt:"<",gt:">",quot:'"'};return n.unescape=function(t,e){var n="&([a-zA-Z]+?|#[xX][\\da-fA-F]+?|#\\d+?);",s=new RegExp(n),i=function(t,n){if(n=n.toLowerCase(),e&&"nbsp"===n)return"&nbsp;";var s=r[n];if(s)return s;if("#"===n[0]){var i=0;if(i="x"==n[1]?parseInt(n.substr(2),16):parseInt(n.substr(1)))return String.fromCharCode(i)}return""};if(s.test(t)){var a=new RegExp(n,"g");t=t.replace(a,i)}return t},n.prototype.decode=function(t){for(var s=0;s<this.stack.length;s++){var i=this.stack[s];"string"==typeof i?this.stack[s]=n.unescape(i,t):i instanceof e&&i.content&&i.content.decode(t)}return this},n.prototype.dedup=function(){for(var t=0;t<this.stack.length;t++){var n=this.stack[t];if(n instanceof e&&n.content){if(e.duptags.indexOf(n.name)>=0&&!n.attr&&1===n.content.stack.length){var s=n.content.stack[0];if(s.name===n.name){this.stack[t]=s,t--;continue}}n.content.dedup()}}return this},n.prototype.strip=function(t,n){n||(n=!(t&&!n)||e.newlinetags.indexOf(t.name)>=0);for(var s=/^\s*$/,i=0,r=!0,a=0;a<this.stack.length;a++){var o=this.stack[a];if(o instanceof e){if(r=!0,o.content){var c;if(i<=0)c=n;else{c=!1;for(var h=a-1;h>=0;h--){var f=this.stack[h];if(f instanceof e){c=e.newlinetags.indexOf(f.name)>=0;break}if("string"!=typeof f||!s.test(f))break}}o.content.strip(o,c)}}else if("string"==typeof o&&s.test(o)&&r)continue;i++}r=!0;for(var l=[],p=0,a=0;a<this.stack.length;a++){var o=this.stack[a];if("string"==typeof o&&s.test(o)&&n){if(r)continue;n=!1}else if(o instanceof e){if(r=!0,e.noemptyattrtags.indexOf(o.name)>=0){if(!o.attr)continue;var u=!1;for(var d in o.attr)if(o.attr[d]){u=!0;break}if(!u)continue}if(e.noemptytags.indexOf(o.name)>=0&&!o.content)continue;n=e.newlinetags.indexOf(o.name)>=0}else{if(n&&!(o=o.replace(/^\s+/g,"")))continue;o=o.replace(/\s+/g," "),r=!1,n=!1}p++,l.push(o)}var o=l[p-1];return"string"==typeof o&&(p>=2&&s.test(o)?(l.splice(p-1,1),p--):/\S\s+$/.test(o)&&(l[p-1]=o.replace(/\s+$/,""))),p<=0&&t?void delete t.content:(this.stack=l,this)},n.prototype.showtree=function(t,n){t||(t=""),n||(n=0);for(var s=0;s<this.stack.length;s++){var i=this.stack[s];i instanceof e?(console.log(t,i.name,i.attr?JSON.stringify(i.attr):""),i.content&&i.content.showtree(t+"--",n+1)):"string"==typeof i&&console.log(t,JSON.stringify(i))}},s.maps={a:{section:"url",attr:"href"},img:{section:"img",data:"src",empty:!0},em:{section:"i"},i:{section:"i"},strong:{section:"b"},b:{section:"b"},del:{section:"s"},s:{section:"s"},ins:{section:"u"},u:{section:"u"},center:{section:"center"},ul:{section:"ul"},ol:{section:"ol"},li:{section:"li",newline:1},blockquote:{section:"quote"},code:{section:"code"},pre:{section:"code"},font:{extend:["color","face","size"]},span:{extend:["color","face","size"]},color:{section:"color",attr:"color"},size:{section:"size",attr:"size"},face:{section:"font",attr:"face"},h1:{section:"h1",newline:1},h2:{section:"h2",newline:1},h3:{section:"h3",newline:1},h4:{section:"h4",newline:1},h5:{section:"h5",newline:1},h6:{section:"h6",newline:1},p:{newline:1},br:{newline:2,empty:!0},table:{newline:1},tr:{newline:1},div:{newline:0},"!doctype":{ignore:!0},head:{ignore:!0},style:{ignore:!0},script:{ignore:!0},meta:{ignore:!0},link:{ignore:!0}},s.prototype.open=function(t,e,n){t&&(t instanceof Array?this.stack=this.stack.concat(t):this.stack.push({section:t,attr:e,data:n}))},s.prototype.append=function(t){this.solidify(),this._append(t)},s.prototype._append=function(t){t&&(this.s+=t,this.weaknewline=!1)},s.prototype.solidify=function(){var t;for(t=0;t<this.stack.length;t++){var e=this.stack[t],n=e.section,s=e.attr,i=e.data,r="["+n;if("string"==typeof s)r+="="+s;else for(var a in s)r+=" "+a+"="+s[a];r+="]",i&&(r+=i),this._append(r)}t>0&&(this.stack=[])},s.prototype.close=function(t){t&&(this.solidify(),this._append("[/"+t+"]"))},s.prototype.rollback=function(){this.stack=[]},s.prototype.newline=function(t){2===t?(this.append("\n"),this.weaknewline=!0):this.weaknewline||(this.append("\n"),this.weaknewline=!0)},s.prototype.toString=function(){return this.s},i.prototype.color=function(t){if(t){var e=/rgba?\s*?\(\s*?(\d{1,3})\s*?,\s*?(\d{1,3})\s*?,\s*?(\d{1,3})\s*?.*?\)/i;if(e.test(t)){var n=function(t){return t.length<2&&(t="0"+t),t};t=t.replace(e,function(t,e,s,i){return e=n(parseInt(e).toString(16)),s=n(parseInt(s).toString(16)),i=n(parseInt(i).toString(16)),"#"+e+s+i})}return t}},i.prototype.size=function(t){if(t){var e=[0,12,14,16,18,24,32,48],n=[null,"smaller","small","medium","large","x-large","xx-large","-webkit-xxx-large"];if(/^\d+$/.test(t))return t;if(/^\d+?px$/.test(t)){if((t=parseInt(t))&&!(t<0)){if(!this.opts.transsize)return t.toString();for(var s=e.length;s>=0;s--){if(0===s)return"1";if(t>=e[s])return s.toString()}return t?t.toString():void 0}}else{var i=n.indexOf(t);if(i>0)return this.opts.transsize?i.toString():e[i].toString()}}},i.prototype.px=function(t){if(t)return t=parseInt(t),t?t.toString():void 0},i.prototype.convertStyle=function(t,e){if(e){var n=[],i=this,r=this.opts,a=function(e){if(e&&!e.ignore&&(e.section||e.extend&&e.extend.length>0)){var s={section:e.section};if(e.attr){if(!t.attr)return;switch(e.section){case"size":s.attr=i.size(t.attr[e.attr]);break;case"color":s.attr=i.color(t.attr[e.attr]);break;default:s.attr=t.attr[e.attr]}if(t.attr.style){var a;switch(e.section){case"size":a=t.attr.style["font-size"],a&&(a=i.size(a));break;case"color":a=t.attr.style.color,a&&(a=i.color(a));break;case"font":a=t.attr.style["font-family"]}a&&(s.attr=a)}if(!s.attr)return}else if("img"===e.section&&r.imagescale){var o,c;if(t.attr){if(o=i.px(t.attr.width),c=i.px(t.attr.height),t.attr.style){var h,f;h=i.px(t.attr.style.width),f=i.px(t.attr.style.height),h&&(o=h),f&&(c=f)}o&&c?s.attr=o+"x"+c:(o||c)&&(s.attr=o?{width:o}:{height:c})}}e.data&&(s.data=t.attr[e.data]),n.push(s)}};if(t.attr&&t.attr.style){if("b"!==t.name&&"strong"!==t.name){var o=t.attr.style["font-weight"];("bold"===o||/^\d+$/.test(o)&&parseInt(o)>=700)&&a(s.maps.b)}if("center"!==t.name){var o=t.attr.style["text-align"];"center"!==o||r.noalign||a(s.maps.center)}if("em"!==t.name&&"i"!==t.name){var o=t.attr.style["font-style"];"italic"!==o&&"oblique"!==o||a(s.maps.i)}}if("list"===e.section||"ul"===e.section||"ol"===e.section||"li"===e.section){if(r.nolist)return[]}else if("center"===e.section){if(r.noalign)return[]}else if(/^h\d+$/.test(e.section)&&r.noheadings){var c=[null,"32px","24px","19px","16px","14px","12px"],h=e.section.match(/^h(\d+)$/),f=parseInt(h[1]);return f<=0?[]:(f>=c.length&&(f=c.length),n.push({section:"size",attr:i.size(c[f])}),n)}if("extend"in e)for(var l=0;l<e.extend.length;l++){var p=e.extend[l];a(s.maps[p])}else a(e);return n}},i.prototype.convert=function(t){var n=new s;if(!t)return n;var i=this,r=function(t,a){for(var o=0;o<t.length;o++){var c=t[o];if(c instanceof e)if(c.name in s.maps){var h=0,f=s.maps[c.name];if(f.ignore)continue;if("newline"in f&&(h=f.newline,n.newline(f.newline)),!c.content&&!f.empty)continue;var l=i.convertStyle(c,f);n.open(l),c.content&&r(c.content.stack,h);for(var p=l.length-1;p>=0;p--)n.close(l[p].section);h&&n.newline()}else c.content&&r(c.content.stack);else"string"==typeof c&&n.append(c)}};return r(t.stack),n},i.prototype.parse=function(t){return(new n).parse(t).strip().dedup().decode()},i.prototype.feed=function(t){var e=this.parse(t);return this.opts.debug&&e.showtree(),this.convert(e)},{HTMLTag:e,HTMLStack:n,BBCode:s,HTML2BBCode:i}})},297:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"arhibash_root"},[n("div",{staticClass:"arhibash_header header"},[n("button",{staticClass:"bttn icon-angle-left",on:{click:t.openPrevBash}}),t._v(" "),n("button",{staticClass:"bttn icon-angle-right",on:{click:t.openNextBash}}),t._v(" "),n("span",{staticClass:"flex_splitter"},[t._v(t._s(t.postTitle))]),t._v(" "),n("button",{staticClass:"bttn",on:{click:t.newBash}},[t._v("Новый пост")]),t._v(" "),n("button",{staticClass:"bttn",on:{click:t.saveBash}},[t._v("Сохранить")])]),t._v(" "),n("div",{staticClass:"arhibash_conteiner"},[n("medium-editor",{staticClass:"arhibash_post",attrs:{text:t.pagetext,"custom-tag":"div",options:{toolbar:{buttons:["bold","italic","underline","strikethrough"]},anchorPreview:!1,disableExtraSpaces:!0,paste:{forcePlainText:!1}},"data-placeholder":" "},on:{edit:function(e){t.editBash(e)}}})],1)])},i=[],r={render:s,staticRenderFns:i};e.a=r}});
//# sourceMappingURL=3.build.js.map